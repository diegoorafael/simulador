function simular() {
    // Pegar valores dos inputs
    const valorCarro = parseFloat(document.getElementById('valorCarro').value);
    const entrada = parseFloat(document.getElementById('entrada').value);
    const parcelaFinanc = parseFloat(document.getElementById('parcelaFinanc').value);
    const parcelaAssin = parseFloat(document.getElementById('parcelaAssin').value);
    const selicAnual = parseFloat(document.getElementById('selicAnual').value) / 100;
    const meses = parseInt(document.getElementById('meses').value);

    // 1. CÁLCULO FINANCIAMENTO
    const totalPagoFinanc = entrada + (parcelaFinanc * meses);
    // Depreciação estimada: 10% ao ano (média simples para o exemplo)
    const taxaDepreciacaoAnual = 0.10;
    const patrimonioCarro = valorCarro * Math.pow((1 - taxaDepreciacaoAnual), (meses / 12));

    // 2. CÁLCULO ASSINATURA + INVESTIMENTO
    const totalPagoAssin = parcelaAssin * meses;
    
    // Converter Selic Anual para Mensal (Fórmula Equivalência)
    const selicMensal = Math.pow((1 + selicAnual), (1/12)) - 1;
    
    // Investimento da Entrada (Juros Compostos)
    let montanteInvestido = entrada * Math.pow((1 + selicMensal), meses);
    
    // Diferença de parcelas (se a assinatura for mais barata que a parcela do financiamento)
    // O usuário "economiza" a diferença e também investe
    const economiaMensal = parcelaFinanc - parcelaAssin;
    if (economiaMensal > 0) {
        for (let i = 0; i < meses; i++) {
            montanteInvestido += economiaMensal * Math.pow((1 + selicMensal), (meses - i));
        }
    }

    // Cálculo de Imposto de Renda sobre o LUCRO (Regressivo 15% para > 2 anos)
    const lucroBruto = montanteInvestido - entrada - (economiaMensal > 0 ? economiaMensal * meses : 0);
    const imposto = lucroBruto * 0.15;
    const patrimonioFinalAssin = montanteInvestido - imposto;

    // EXIBIR RESULTADOS
    document.getElementById('resultado').classList.remove('hidden');
    document.getElementById('totalFinanc').innerText = totalPagoFinanc.toLocaleString('pt-BR', {style: 'currency', currency: 'BRL'});
    document.getElementById('patrimonioFinanc').innerText = patrimonioCarro.toLocaleString('pt-BR', {style: 'currency', currency: 'BRL'});
    
    document.getElementById('totalAssin').innerText = totalPagoAssin.toLocaleString('pt-BR', {style: 'currency', currency: 'BRL'});
    document.getElementById('patrimonioAssin').innerText = patrimonioFinalAssin.toLocaleString('pt-BR', {style: 'currency', currency: 'BRL'});

    const veredito = document.getElementById('veredito');
    if (patrimonioFinalAssin > patrimonioCarro) {
        veredito.innerHTML = `Vantagem para ASSINATURA: <br> Você termina com R$ ${(patrimonioFinalAssin - patrimonioCarro).toLocaleString('pt-BR')} a mais no bolso.`;
        veredito.style.background = "#d4edda";
        veredito.style.color = "#155724";
    } else {
        veredito.innerHTML = `Vantagem para FINANCIAMENTO: <br> O carro próprio supera o investimento em R$ ${(patrimonioCarro - patrimonioFinalAssin).toLocaleString('pt-BR')}.`;
        veredito.style.background = "#f8d7da";
        veredito.style.color = "#721c24";
    }
}
