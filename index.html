<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Matemática do Carro | Inteligência Financeira</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        :root { --brand: #00ff88; --bg: #000000; --card: #0a0a0a; --border: rgba(255,255,255,0.08); }
        body { background-color: var(--bg); color: #fff; font-family: 'Inter', sans-serif; scroll-behavior: smooth; }
        
        /* Efeito de Gradiente Animado */
        .glow-text { background: linear-gradient(to right, #00ff88, #00bdff, #00ff88); background-size: 200% auto; -webkit-background-clip: text; -webkit-text-fill-color: transparent; animation: shine 3s linear infinite; }
        @keyframes shine { to { background-position: 200% center; } }

        .bento-card { background: var(--card); border: 1px solid var(--border); border-radius: 24px; padding: 2rem; transition: all 0.4s ease; }
        .bento-card:hover { border-color: rgba(0, 255, 136, 0.3); transform: translateY(-4px); }

        .input-modern { background: #111; border: 1px solid var(--border); color: #fff; padding: 14px; border-radius: 14px; width: 100%; outline: none; transition: 0.3s; font-size: 0.95rem; }
        .input-modern:focus { border-color: var(--brand); box-shadow: 0 0 20px rgba(0, 255, 136, 0.1); }

        .btn-glow { background: var(--brand); color: #000; font-weight: 800; padding: 1rem 2rem; border-radius: 16px; transition: 0.3s; box-shadow: 0 0 30px rgba(0, 255, 136, 0.2); }
        .btn-glow:hover { transform: scale(1.02); box-shadow: 0 0 40px rgba(0, 255, 136, 0.4); }

        .chart-container { position: relative; height: 350px; width: 100%; }
        
        /* Botão WhatsApp Minimalista */
        .wa-button { position: fixed; bottom: 30px; right: 30px; background: #fff; color: #000; padding: 12px 24px; border-radius: 100px; font-weight: 700; display: flex; align-items: center; gap: 8px; z-index: 99; transition: 0.3s; }
        .wa-button:hover { background: var(--brand); }
    </style>
</head>
<body>

    <a href="https://wa.me/55XXXXXXXXXXX" target="_blank" class="wa-button">
        <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24"><path d="M12.031 6.172c-3.181 0-5.767 2.586-5.767 5.767 0 1.267.412 2.433 1.103 3.381l-.717 2.103 2.147-.67c.922.549 1.99.874 3.134.874 3.181 0 5.767-2.586 5.767-5.767 0-3.181-2.586-5.767-5.767-5.767zm0 10.461c-1.02 0-1.97-.311-2.761-.844l-1.253.391.417-1.226c-.615-.815-.98-1.821-.98-2.91 0-2.628 2.139-4.767 4.767-4.767 2.628 0 4.767 2.139 4.767 4.767 0 2.628-2.139 4.767-4.767 4.767z"/></svg>
        Consultoria via WhatsApp
    </a>

    <nav class="p-8 flex justify-between items-center max-w-7xl mx-auto">
        <div class="text-2xl font-extrabold tracking-tighter">M<span class="text-green-500">D</span>C</div>
        <div class="flex gap-6 text-xs uppercase font-bold tracking-widest text-gray-500">
            <a href="#simulador" class="hover:text-white">Simulador</a>
            <a href="#metodo" class="hover:text-white">Método</a>
        </div>
    </nav>

    <header class="py-24 text-center px-6">
        <h1 class="text-6xl md:text-8xl font-extrabold tracking-tighter mb-8 leading-none">
            A matemática do <br><span class="glow-text">carro próprio.</span>
        </h1>
        <p class="text-gray-400 text-lg max-w-xl mx-auto mb-12">
            Desenvolvido por um mecânico especialista em viabilidade financeira. Simule agora e descubra onde seu dinheiro rende de verdade.
        </p>
        <a href="#simulador" class="btn-glow">Começar Simulação Gratuita</a>
    </header>

    <main id="simulador" class="max-w-7xl mx-auto px-6 pb-40">
        <div class="grid grid-cols-1 lg:grid-cols-12 gap-6">
            
            <div class="lg:col-span-4 bento-card space-y-6">
                <h3 class="text-sm font-bold uppercase text-gray-500 tracking-widest mb-4">Configuração</h3>
                
                <div class="space-y-4">
                    <div>
                        <label class="text-[10px] font-bold text-gray-600 uppercase">Valor do Carro</label>
                        <input type="text" id="vCarroDisp" class="input-modern" value="R$ 120.000,00" oninput="mask(this, 'vCarro')">
                        <input type="hidden" id="vCarro" value="120000">
                    </div>
                    <div>
                        <label class="text-[10px] font-bold text-gray-600 uppercase">Entrada</label>
                        <input type="text" id="vEntradaDisp" class="input-modern" value="R$ 50.000,00" oninput="mask(this, 'vEntrada')">
                        <input type="hidden" id="vEntrada" value="50000">
                    </div>
                    <div>
                        <label class="text-[10px] font-bold text-gray-600 uppercase">Selic Anual (%)</label>
                        <input type="number" id="tSelicAnual" class="input-modern" value="12.75" oninput="calcular()">
                    </div>
                    <div>
                        <label class="text-[10px] font-bold text-gray-600 uppercase">Mensalidade Assinatura</label>
                        <input type="text" id="vAssinaturaDisp" class="input-modern" value="R$ 2.800,00" oninput="mask(this, 'vAssinatura')">
                        <input type="hidden" id="vAssinatura" value="2800">
                    </div>
                </div>

                <div class="pt-6">
                    <button onclick="setPerfil('popular')" class="w-full text-left text-xs text-gray-500 py-2 hover:text-white transition">+ Carro Popular</button>
                    <button onclick="setPerfil('premium')" class="w-full text-left text-xs text-gray-500 py-2 hover:text-white transition">+ Carro Premium</button>
                </div>
            </div>

            <div class="lg:col-span-8 grid grid-cols-1 md:grid-cols-2 gap-6">
                
                <div class="bento-card md:col-span-2 flex flex-col md:flex-row justify-between items-center gap-8 bg-gradient-to-br from-[#0a0a0a] to-[#0d1a14]">
                    <div class="text-center md:text-left">
                        <p class="text-[10px] font-bold text-gray-500 uppercase tracking-widest mb-1">Resultado Projetado (48 Meses)</p>
                        <h2 id="textoVeredito" class="text-xl md:text-2xl font-bold leading-tight">Calculando impacto...</h2>
                    </div>
                    <div class="flex gap-4">
                        <div class="text-right">
                            <p class="text-[10px] text-gray-500 uppercase">Banco (Líquido)</p>
                            <p id="resFinalAssin" class="text-2xl font-extrabold text-green-500">R$ 0,00</p>
                        </div>
                        <div class="text-right">
                            <p class="text-[10px] text-gray-500 uppercase">Venda Carro</p>
                            <p id="resFinalFinanc" class="text-2xl font-extrabold">R$ 0,00</p>
                        </div>
                    </div>
                </div>

                <div class="bento-card md:col-span-2">
                    <div class="chart-container">
                        <canvas id="meuGrafico"></canvas>
                    </div>
                </div>

                <details class="md:col-span-2 text-gray-600 text-xs">
                    <summary class="cursor-pointer hover:text-white transition p-2">Ajustes Avançados (Depreciação, Juros, IR)</summary>
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 p-4">
                        <div>
                            <label>Depreciação AA (%)</label>
                            <input type="number" id="pDepreciacaoAnual" class="input-modern mt-1" value="12.0" oninput="calcular()">
                        </div>
                        <div>
                            <label>Custos Posse (%)</label>
                            <input type="number" id="pCustosAnuais" class="input-modern mt-1" value="10.0" oninput="calcular()">
                        </div>
                        <div>
                            <label>Juros Banco (% AM)</label>
                            <input type="number" id="tJuros" class="input-modern mt-1" value="1.60" oninput="calcular()">
                        </div>
                        <div>
                            <label>IR sobre Lucro (%)</label>
                            <input type="number" id="tIR" class="input-modern mt-1" value="15" oninput="calcular()">
                        </div>
                    </div>
                </details>
            </div>
        </div>
    </main>

    <script>
        let chart;
        const fmt = (v) => v.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });

        function mask(i, id) {
            let v = i.value.replace(/\D/g, "");
            v = (v / 100).toFixed(2);
            let p = v.split(".");
            p[0] = p[0].replace(/\B(?=(\d{3})+(?!\d))/g, ".");
            i.value = "R$ " + p[0] + "," + p[1];
            document.getElementById(id).value = v;
            calcular();
        }

        function setPerfil(tipo) {
            const vC = document.getElementById('vCarroDisp');
            const vA = document.getElementById('vAssinaturaDisp');
            if (tipo === 'popular') {
                updateField(vC, 'vCarro', 85000);
                document.getElementById('tJuros').value = "1.49";
                updateField(vA, 'vAssinatura', 2150);
            } else if (tipo === 'premium') {
                updateField(vC, 'vCarro', 280000);
                document.getElementById('tJuros').value = "1.89";
                document.getElementById('pDepreciacaoAnual').value = "18.0";
                updateField(vA, 'vAssinatura', 6200);
            }
            calcular();
        }

        function updateField(input, hiddenId, valor) {
            document.getElementById(hiddenId).value = valor;
            input.value = "R$ " + valor.toLocaleString('pt-BR', {minimumFractionDigits: 2});
        }

        function calcular() {
            const vCarro = parseFloat(document.getElementById('vCarro').value) || 0;
            const vEntrada = parseFloat(document.getElementById('vEntrada').value) || 0;
            const vAssinatura = parseFloat(document.getElementById('vAssinatura').value) || 0;
            const tSelicAnual = parseFloat(document.getElementById('tSelicAnual').value) || 0;
            const tIR = (parseFloat(document.getElementById('tIR').value) / 100) || 0.15;
            
            const tSelicLiquidaAnual = tSelicAnual * (1 - tIR); 
            const tSelicMensal = (Math.pow(1 + (tSelicLiquidaAnual/100), 1/12) - 1);
            
            const vPrazo = 48;
            const tJuros = (parseFloat(document.getElementById('tJuros').value) / 100) || 0;
            const pDepAnual = (parseFloat(document.getElementById('pDepreciacaoAnual').value) / 100) || 0;
            const pCustos = (parseFloat(document.getElementById('pCustosAnuais').value) / 100) || 0;
            
            const depMensal = 1 - Math.pow(1 - pDepAnual, 1/12);
            const infMensal = (Math.pow(1.045, 1/12) - 1); 

            const custosMes = (vCarro * pCustos) / 12;
            const vFin = vCarro - vEntrada;
            const pmt = vFin > 0 ? (vFin * tJuros) / (1 - Math.pow(1 + tJuros, -vPrazo)) : 0;
            const aporte = (pmt + custosMes) - vAssinatura;

            render(vCarro, vEntrada, aporte, vPrazo, tSelicMensal, pmt, tJuros, vFin, infMensal, depMensal);
        }

        function render(vC, vE, ap, meses, selic, pmt, jF, vF, inf, dep) {
            let sD = vF, pFinanc = [], pAssin = [], sInvest = vE;
            for(let m=0; m<=meses; m++) {
                let vCarroHoje = vC * Math.pow((1 - dep + inf), m);
                if (m > 0) {
                    sD -= (pmt - (sD * jF));
                    sInvest = (sInvest + ap) * (1 + selic);
                }
                pFinanc.push(Math.max(0, vCarroHoje - Math.max(0, sD)));
                pAssin.push(sInvest);
            }
            
            const fF = pFinanc[meses], fA = pAssin[meses];
            document.getElementById('resFinalFinanc').innerText = fmt(fF);
            document.getElementById('resFinalAssin').innerText = fmt(fA);
            
            const texto = document.getElementById('textoVeredito');
            const dif = Math.abs(fA - fF);

            if (fA > fF) {
                texto.innerHTML = `Assinatura é o caminho. <span class='text-green-500'>+${fmt(dif)}</span> no seu bolso.`;
            } else {
                texto.innerHTML = `Compra vence por <span class='text-white'>${fmt(dif)}</span> de vantagem.`;
            }

            if (chart) chart.destroy();
            chart = new Chart(document.getElementById('meuGrafico'), {
                type: 'line',
                data: {
                    labels: Array.from({length: meses + 1}, (_, i) => i),
                    datasets: [
                        { data: pFinanc, borderColor: '#333', borderWidth: 2, pointRadius: 0 },
                        { data: pAssin, borderColor: '#00ff88', borderWidth: 4, pointRadius: 0 }
                    ]
                },
                options: { 
                    responsive: true, maintainAspectRatio: false, 
                    plugins: { legend: { display: false } },
                    scales: { y: { display: false }, x: { grid: { display: false }, ticks: { display: false } } }
                }
            });
        }
        window.onload = calcular;
    </script>
</body>
</html>
